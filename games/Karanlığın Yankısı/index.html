<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kör Adalet: Nihai Sürüm</title>
    <style>
        body { background-color: #010101; color: #555; font-family: 'Courier New', monospace; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; overflow: hidden; box-shadow: inset 0 0 200px #400; }
        #game-container { max-width: 950px; width: 95%; text-align: center; padding: 30px; border: 1px solid #200; background-color: rgba(0, 0, 0, 0.98); border-radius: 5px; position: relative; }
        #status-bar { font-size: 0.8em; color: #444; margin-bottom: 20px; display: flex; justify-content: space-between; border-bottom: 1px solid #200; padding-bottom: 10px; }
        #text-area { font-size: 1.1em; line-height: 1.7; margin-bottom: 25px; min-height: 380px; text-align: justify; color: #888; overflow-y: auto; padding-right: 15px; }
        #button-area { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        button { background-color: #080000; color: #666; border: 1px solid #222; padding: 15px; cursor: pointer; font-family: inherit; transition: 0.4s; text-transform: uppercase; font-size: 0.85em; width: 100%; }
        button:hover:not(:disabled) { background-color: #1a0000; color: #fff; border-color: #f00; box-shadow: 0 0 10px #600; }
        button:disabled { color: #111; border-color: #050505; cursor: not-allowed; }
        .critical { color: #f00 !important; font-weight: bold; }
        .success { color: #0f0 !important; font-weight: bold; }
        .gold { color: #ffd700 !important; text-shadow: 0 0 15px #ffd700; }
        .ach-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-top: 20px; font-size: 0.7em; }
        .ach-item { padding: 8px; border: 1px solid #111; color: #222; text-transform: uppercase; }
        .ach-unlocked { border-color: #500; color: #888; }
        .exit-btn { grid-column: span 2; background: #111; color: #444; border: 1px solid #222; margin-top: 10px; }
    </style>
</head>
<body>

<div id="game-container">
    <div id="ui-elements" style="display: none;">
        <div id="status-bar">
            <span>ZİHİN: <span id="stat-sanity">100</span></span>
            <span>ENVANTER: <span id="stat-inv">Boş</span></span>
            <span>GÜVEN: <span id="stat-trust">ZAYIF</span></span>
        </div>
    </div>
    <div id="text-area">
        <h1 style="color:#500; letter-spacing: 15px;">KÖR ADALET</h1>
        <p style="text-align: center;">"Bazı hataların telafisi, bazı günahların affı yoktur."</p>
        <div id="achievement-gallery" class="ach-grid"></div>
    </div>
    <div id="button-area">
        <button onclick="startGame()" style="grid-column: span 2;">KADERİNE YÜRÜ</button>
        <button class="exit-btn" onclick="exitGame()">SİSTEMİ KAPAT</button>
    </div>
</div>

<script>
    let state = { sanity: 100, trust: 0, inventory: [], visited: [], dialogs: 0, goldPath: true };
    const achList = [
        { id: 'gold_team', title: 'Altın Kader' },
        { id: 'revenge', title: 'İntikam' },
        { id: 'sacrifice', title: 'Fedakarlık' },
        { id: 'gas_death', title: 'Boğulma' },
        { id: 'trap_death', title: 'Kıyma Makinesi' }
    ];

    function renderAchievements() {
        const gallery = document.getElementById('achievement-gallery');
        if (!gallery) return;
        const unlocked = JSON.parse(localStorage.getItem('aras_ach_final') || '[]');
        gallery.innerHTML = achList.map(a => `
            <div class="ach-item ${unlocked.includes(a.id) ? 'ach-unlocked' : ''}">
                ${unlocked.includes(a.id) ? a.title : '???'}
            </div>
        `).join('');
    }

    function unlockAch(id) {
        let unlocked = JSON.parse(localStorage.getItem('aras_ach_final') || '[]');
        if(!unlocked.includes(id)) unlocked.push(id);
        localStorage.setItem('aras_ach_final', JSON.stringify(unlocked));
        renderAchievements();
    }

    function exitGame() {
        if(confirm("Gerçekten çıkmak istiyor musun? İlerlemen kaybolacak.")) window.close();
    }

    function updateUI(text, options) {
        const textArea = document.getElementById('text-area');
        const buttonArea = document.getElementById('button-area');
        textArea.innerHTML = text;
        buttonArea.innerHTML = '';
        
        options.forEach(opt => {
            const btn = document.createElement('button');
            btn.innerText = opt.text;
            if (opt.disabled) btn.disabled = true;
            btn.onclick = () => { if(opt.effect) opt.effect(); opt.action(); };
            buttonArea.appendChild(btn);
        });

        document.getElementById('stat-sanity').innerText = state.sanity;
        document.getElementById('stat-inv').innerText = state.inventory.length > 0 ? state.inventory.join(', ') : "Boş";
        document.getElementById('stat-trust').innerText = state.trust >= 50 ? "YÜKSEK" : "ZAYIF";
    }

    function startGame() {
        state = { sanity: 100, trust: 0, inventory: [], visited: [], dialogs: 0, goldPath: true };
        document.getElementById('ui-elements').style.display = 'block';
        updateUI("Eren karanlıkta fısıldıyor: 'Bizi buraya o getirdi Aras. Hatırlıyor musun? 5 yıl önceki o geceyi... Yangın merdivenini aslında ben kilitlemiştim.'", [
            { text: "ONU AFFET VE GÜVEN VER", effect: () => state.trust += 30, action: corridorHub },
            { text: "ÖFKELEN VE ONU SUSTUR", effect: () => {state.trust -= 20; state.sanity -= 10;}, action: corridorHub }
        ]);
    }

    function corridorHub() {
        updateUI("Ana Koridor. Sessizlik ölümcül. Altın bir kader için hata payın yok.", [
            { text: "Tünel 1: GAZ ODASI", action: tunnel1, disabled: state.visited.includes(1) },
            { text: "Tünel 2: KABLOLAR", action: tunnel2, disabled: state.visited.includes(2) },
            { text: "TÜNEL 3: CESARET VE GÜVEN", action: tunnel3_start, disabled: state.visited.includes(3) },
            { text: "Tünel 4: FEDA", action: tunnel4, disabled: state.visited.includes(4) },
            { text: "Tünel 5: GİZLİ KASA", action: vaultRoom },
            { text: "Tünel 6: KAÇIŞ", action: tunnel6, disabled: state.visited.includes(6) }
        ]);
    }

    function tunnel1() {
        state.visited.push(1);
        updateUI("Tünel 1: Odaya gaz doluyor. Maske tek kişilik.", [
            { text: "MASKEYİ EREN'E VER", effect: () => state.trust += 40, action: () => {
                updateUI("<p class='success'>FEDAKARLIK:</p> Kendi ciğerlerin yanarken Eren'i kurtardın. Eren sana borçlu hissetti.", [{text: "KORİDORA DÖN", action: corridorHub}]);
            }},
            { text: "KENDİNİ KURTAR", action: () => {
                unlockAch('gas_death');
                updateUI("<p class='critical'>ÖLÜM:</p> Boğuşurken maske parçalandı. İkiniz de can verdiniz.", [{text: "BAŞTAN BAŞLA", action: startGame}]);
            }}
        ]);
    }

    function tunnel2() {
        state.visited.push(2);
        updateUI("Tünel 2: Kapıda iki kablo var.", [
            { text: "MAVİ KABLO", action: () => {
                updateUI("<p class='success'>GÜVENLİ:</p> Kapı açıldı.", [{text: "KORİDORA DÖN", action: corridorHub}]);
            }},
            { text: "KIRMIZI KABLO", action: () => {
                updateUI("<p class='critical'>ÖLÜM:</p> Tünel üzerinize çöktü.", [{text: "BAŞTAN BAŞLA", action: startGame}]);
            }}
        ]);
    }

    function tunnel3_start() {
        state.visited.push(3);
        updateUI("Selim: 'Aras... Birbirinizi satmadan sonuna kadar gidebilecek misiniz?'", [
            { text: "EL ELE, ÖZGÜRLÜĞE!", effect: () => state.trust += 50, action: tunnel3_final },
            { text: "BEN TEK GİDERİM", effect: () => state.trust -= 50, action: () => {
                updateUI("<p class='critical'>BENCİLLİK:</p> Selim bencil olduğun için tetiği çekti.", [{text: "BAŞTAN BAŞLA", action: startGame}]);
            }}
        ]);
    }

    function tunnel3_final() {
        if(state.trust >= 80) {
            unlockAch('gold_team');
            updateUI("<h1 class='gold'>ALTIN KADER</h1><p>Gerçek bir bağ kurdunuz ve her şeyi affederek dışarı çıktınız.</p>", [{text: "ANA MENÜ", action: () => location.reload()}]);
        } else {
            updateUI("<p class='success'>GÜVEN ARTTI:</p> Selim etkilenmiş görünüyor ama henüz tam değil.", [{text: "KORİDORA DÖN", action: corridorHub}]);
        }
    }

    function tunnel4() {
        state.visited.push(4);
        updateUI("Tünel 4: Eren'in kolu dişliler arasında!", [
            { text: "BORUYU TUT", effect: () => {state.sanity -= 30; state.trust += 50;}, action: () => {
                updateUI("<p class='success'>KURTULUŞ:</p> Eren'i kurtardın.", [{text: "KORİDORA DÖN", action: corridorHub}]);
            }},
            { text: "EREN'İ BIRAK", action: () => {
                unlockAch('trap_death');
                updateUI("<p class='critical'>ÖLÜM:</p> Sen de dişlilerin içine çekildin.", [{text: "BAŞTAN BAŞLA", action: startGame}]);
            }}
        ]);
    }

    function vaultRoom() {
        const pass = prompt("Şifre (O Gece - Yıl):");
        if(pass === "1985") {
            state.inventory.push("SİLAH");
            updateUI("<p class='success'>SİLAH ALINDI:</p> Artık cellat sensin.", [{text: "KORİDORA DÖN", action: corridorHub}]);
        } else {
            alert("Yanlış Şifre!");
            corridorHub();
        }
    }

    function tunnel6() {
        state.visited.push(6);
        updateUI("Tünel 6: Fanlar dönüyor.", [
            { text: "METAL ÇUBUK AT", action: () => {
                updateUI("<p class='success'>YOL AÇILDI:</p> Fan durdu.", [{text: "KORİDORA DÖN", action: corridorHub}]);
            }},
            { text: "GEÇMEYE ÇALIŞ", action: () => {
                updateUI("<p class='critical'>ÖLÜM:</p> Parçalara ayrıldın.", [{text: "BAŞTAN BAŞLA", action: startGame}]);
            }}
        ]);
    }

    renderAchievements();
</script>
</body>
</html>